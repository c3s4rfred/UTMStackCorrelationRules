# Rule version v1.0.2

- name: "Windows Defender: Antimalware engine found malware or other potentially unwanted software"
  severity: "High"
  description: "This rule is triggered when the antimalware engine detects malware or potentially unwanted software on the system. 
                This alert is critical to identify the presence of threats and unwanted software that may compromise system security and performance."
  solution: "Upon generation of this alert, it is imperative to take immediate action to neutralize the threat or unwanted software. 
            The procedure established by the antimalware vendor must be followed to remove, quarantine, or take appropriate actions to mitigate the impact of detection. 
            In addition, it is essential to keep your virus definitions and anti-malware engine up to date to ensure continuous and effective protection against future threats."
  category: "Execution"
  tactic: "Event Triggered Execution"
  dataTypes: ["wineventlog"]
  reference: 
    - "https://attack.mitre.org/tactics/TA0002/"
    - "https://attack.mitre.org/techniques/T1546/"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.wineventlog.event.provide"
          operator: "=="
          value: "SecurityCenter"
        - field: "logx.wineventlog.event_id"
          operator: "in"
          value: 1006,1015,1116
      timeLapse: 60
      minCount: 1
      save:
        - field: "logx.wineventlog.event_data.SubjectUserName"
          alias: "SourceUser"
        - field: "logx.wineventlog.host.name"
          alias: "SourceHost"
        - field: "logx.wineventlog.host.ip.1"
          alias: "SourceIP"
        - field: "logx.wineventlog.event_data.IpPort"
          alias: "SourcePort"
        - field: "logx.wineventlog.event_data.TargetUserName"
          alias: "DestinationUser"
