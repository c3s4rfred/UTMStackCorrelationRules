# Rule version v1.0.2

- name: "Windows: Domain Policy was changed"
  severity: "Low"
  description: "Generates an alert when a domain policy change is made on an Active Directory domain controller in a Windows environment. 
                These types of changes may include the creation, modification, or removal of security policies in the domain, 
                which can have a significant impact on the security and operation of systems and users in the domain."
  solution: "When an alert generated by this rule is detected, it is essential that the security and systems management team perform a thorough review of the event and the domain policy change. 
            It should be verified if the change was authorized and made by a legitimate administrator or if it is the result of malicious or unauthorized activity. 
            If the change is determined to be suspicious or unauthorized, corrective action should be taken, such as reverting the change, reviewing access controls, 
            and conducting additional investigation to identify and mitigate any potential threats."
  category: "Privilege Escalation"
  tactic: "Domain Policy Modification"
  dataTypes: ["wineventlog"]
  reference:
    - "https://attack.mitre.org/tactics/TA0004/"
    - "https://attack.mitre.org/techniques/T1484/"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.wineventlog.event_id"
          operator: "=="
          value: 4739
      timeLapse: 60
      minCount: 1
      save:
        - field: "logx.wineventlog.event_data.SubjectUserName"
          alias: "SourceUser"
        - field: "logx.wineventlog.host.name"
          alias: "SourceHost"
        - field: "logx.wineventlog.host.ip.1"
          alias: "SourceIP"
        - field: "logx.wineventlog.event_data.IpPort"
          alias: "SourcePort"
        - field: "logx.wineventlog.event_data.TargetUserName"
          alias: "DestinationUser"
