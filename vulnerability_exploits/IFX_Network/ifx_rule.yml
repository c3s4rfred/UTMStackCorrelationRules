- name: "IFX Ransomware Detection Rule"
  severity: "High"
  description: "Detects a possible ransomware attack. This rule is based on the identification of unusual patterns of activity, such as changes in system performance, IOCs, and data alterations."
  solution: "In response to this alert, organizations should force a full scan with their antivirus.
      Review the operating system logs.Verify that there is no suspicious software on your systems.
      Check existing accounts on your server. Audit processing and hard drive performance.
      Check if there is any alteration in the information or data leak of the company and its databases.
      Audit your network traffic. Maintain an up-to-date record of your systems to ensure effective monitoring."
  category: "Collection"
  tactic: "Automated Exfiltration"
  dataTypes: ["generic"]
  reference: 
    - "https://attack.mitre.org/tactics/TA0009/"
    - "https://attack.mitre.org/techniques/T1020/"
  frequency: 60
  cache:
    - oneOf:
        - field: "logx.*.src_ip"
          operator: "regexp"
          value: "(45.137.22.149|92.42.36.95|185.121.120.179|162.241.205.153|45.137.22.147|91.212.89.57|186.65.73.138|45.87.60.140|103.145.254.33|77.247.110.104|66.36.234.110|103.99.1.238|31.210.21.71|45.170.245.119|104.47.33.54|162.241.211.105|181.119.65.95|104.47.56.48|31.210.20.250|31.210.21.247|185.222.58.100|185.29.8.26|190.15.202.141|103.156.92.46|45.137.22.52|185.121.120.245|153.122.55.69|185.222.57.174)"
        - field: "logx.*.dest_ip"
          operator: "regexp"
          value: "(45.137.22.149|92.42.36.95|185.121.120.179|162.241.205.153|45.137.22.147|91.212.89.57|186.65.73.138|45.87.60.140|103.145.254.33|77.247.110.104|66.36.234.110|103.99.1.238|31.210.21.71|45.170.245.119|104.47.33.54|162.241.211.105|181.119.65.95|104.47.56.48|31.210.20.250|31.210.21.247|185.222.58.100|185.29.8.26|190.15.202.141|103.156.92.46|45.137.22.52|185.121.120.245|153.122.55.69|185.222.57.174)"
        - field: "logx.*.message"
          operator: "regexp"
          value: "(02fab97fe9b0e2e94abd4917fb5bc88d21445760ee37971b919f47c95a01f195|0cbb6c8b7bf0f108b82ac808211852dac62709ceefb84d8e93b2ef912428d24b|1ebb93102f8b08f724aad0bd312006450853d65266c0558a88da622d75c67bd8|23e012a59ae4794e05bd5de9b353f788d9b9ce7045ca27ff5a93b7b922746db4|2775248702bf6bfc3b01f77ace8b5be9f5281eb9e00a6b92323ea4cdca78b2ab|33fa7ababe331e58c82f5ca9423f269d598f321c3e8f700373775bc6c993992d|389f593eff1b5bc4c552f9765ac8b5070f910428b430a4fc16ca6f8379128a52|4b922b87034981af8f69326f64789363ef2b468fc58ddad34c16c5c6bd82e3ca|4cedb439d35ae9db6b9f25b013c9d7c0bcee78990305bc0764d245c70b0c86b0|4e2543aba8686312bc8212b9c799dc233f91d017b5767e91c5fae744d75d152b|5116d89d1fbc3cf87e842b52acd91b70d1cf5a9cd68157fc9ecf9d1b8d3c498c|5f4e4fbde7ed003dc34954ee301977f697de1cd2d52beafd898023797ab47255|65d09004525ac8e3d844232e6f1f99ec26bcf3a24447ee4a55ef0cf805ca0480|65f0e0590469268511ed7b779808f4178386b7d81ad0447d3ae9b5260a42a4d2|67cc5fdee7630da23e8b6b63bd6da843cd7ea1e0fe05f47c2dc57bab10716342|692d2b764da8c746e7abdcb6d09fc5fa92de2729ddab5fbaa22c42155b9df273|6bd884cbbae349fb1933fb97280d2d84a2b71f8adf6c9feb363941c04bb40ef4|71daea6f6dedd5094544dec50a02050559328113afe48df41c93a42ce56e855c|757e11cf6260b6d84410f18cf27cfb50447e15059fffa296add2469967182d57|7e80eb8594da599e745dc646a4fe02aca27c56457aca6a9c35f387c281202c9c|84f5938bf6b3849d4055c64663e26912dd368506a5ca784ebccdfe39cf6cde10|878a4f96c80d638d087347f2f4d9fd09df01b3bff20ce362c9fff16bca94e5bb|95f7f656ee4dee95a46e971797962bc365f9289923a936d2a9b8190bed88b611|976d036150ddef649c0fdffa89bfcaa19f5743e98e45d9cdccb76b66632c8ee5|9b82331902103e80ae6cdda02fa33bdd00cba59bac68c5d6f1109d1b93020e23|a33d4b647cd9a415a96aa0aaa97bbaf2abf2817cf5eef4faf812a3216e9d1a9e|a3d4f2e5e5c91a17786c7c3cea524a17d513735550b30b3d4494fc11d6e1135d|b38df877b327db04dfa2bea03a94ceec82b1942560acfb6c87256be88f707bb2|c3241d3e58071c903d635550d9dd35da14d3602a349c716527e4a9f147b7e4be|c3333735a22b46fa116054c15ea6f273bbbcedef13b633d0b7721d91a57ba2b4|c53c03a021b14ae039a3115115fdd552892ad3e2e19698492c14121dd582ee07|ca91a8dd6f50202cdc5ed444cb1c1f447f2dc108f2c276658f337c93259fb1ce|d109452c99cd984de885f08d3be104145f9d4f5396c2001fd6e048c5ffcbfb3d|d18e005fa449ab6ac3b7febb25dd6a05e16dc7a87f684ed49d6c093a2c61e6c7|d8cbbb4144d9b4350b367fa89b250b4a35933b77c00d36b3e885f2aa17e0aaff|d9507b9760fb0ab4ad0a6ca6e92bdbb16cccd5ce1d5e60cf158dc21114092ff4|e01ebff50cac856b458473e4e7b47ef942fd93d4327ff8f56bd95a43d954bb3a|e55e03e26e7a9c71f639f9aaf6a3c5dfd0138fa4578f9f86d7fce950027d6d2e|e79c26ed16f145a7282b54b3137f09e4100495c7d06c0ea73052762d0877dbd3|e943753978e4c47b5bca140cbcc1e669b7d900fbe3e55fd37aa1b4925c11fd93|eb797eaf04038f3b1330dc4cf7dbfcaca0758a0340082fa223f5399209acb984|ed30c09693df6de5d1ceff9395eb0c8662ffbcd5f8fdaf641f9d4df9e77910de|f74ad88b84c59f91ebb58052bb7b9a1238a93f86f19f6d9015839d38d26f4364|fbc3fb202e26f02612903679f57dd9406546cb79e18d2a0fb31459a276aabe93|fd6ade6040d775af6ddf8c835a1f7b32bb17ccaf5ca227af55df9accfc75329d)"
        - field: "logx.*.message"
          operator: "regexp"
          value: "(PO.#4500499953.rar|1900273.rar|5-12.xlsx|FP_01307970.xlsx|Adress_onfirmation_Portal.htm|Request for Payment Information.r00|VNDR14003140000000000620 pdf.ace|NEW ORDER INQUIRY_B90202821.pdf.gz|Booking.rar|Nuevo orden.img|Scan837400.7z|BL COPY.zip|PI.xlsx|NewPO.cab|Original BL, Invoice & Packing List.html|PO_000630.rar|ADVANCE PAYMENT.rar|New order.rar|Purchase Order_12052021.ace|EU-Business-Register.pdf|Urgent RFQ_AP65425652_032421,pdf.cab|Order 4503860408.zip|Orden de compra 2101903-0.iso|COPIA RAPIDA DE PAGO.zip|VM-(ðŸ“ž)---09_22347.htm|SWIFT20210511094146076.gz|DHL_Telex Release BL.tar.001|Scan_PO AR483-159043 & PO AR483-1590436 FOR J-3000433707.r00|SOA_DEBit Notes & Credit Notes.r01|RFx 6200238509.xlsx|informe bancario.xlsx__________________________________.img|Solicitud_de_cotizacioÌ•n.zip|IMG_93_107_80.R01|Purchase Order 11052021.ace|Shipment Document BL,INV and packing List.ace|Payment Advice.pdf.rar|Purchase Order 12052021.gz|VNDR14003140000000000620 pdf.zip|RFx DescriptionTerms B35O-18342.xlsx|Purchase Order PO-000991.pdf.zip|UL_LLC_11052021,283763pdf.7z|invoice.zip|3pending messages.html|Order-RFQ # 097663899.gz|Factura comercial____PDF.gz|Notificacin de dhl_____PDF.gz|PO.#4500499953.r00)"
        - field: "logx.*.src_ip"
          operator: "regexp"
          value: "(104.168.145.204|122.146.90.200|123.168.11.194|138.199.40.178|144.123.6.70|149.28.203.102|156.146.45.207|192.129.189.73|192.52.167.199|198.46.140.52|212.102.42.90|216.158.232.18|222.173.222.228|37.19.199.202|45.144.227.42)"
        - field: "logx.*.dest_ip"
          operator: "regexp"
          value: "(104.168.145.204|122.146.90.200|123.168.11.194|138.199.40.178|144.123.6.70|149.28.203.102|156.146.45.207|192.129.189.73|192.52.167.199|198.46.140.52|212.102.42.90|216.158.232.18|222.173.222.228|37.19.199.202|45.144.227.42)"
        - field: "logx.*.message"
          operator: "regexp"
          value: "(0284EBC8B81DD2894FBDB7CA298D1C2C85C41630B9B9AB99AED51AEC86073AAE|03C2C9FB9C320044C7C3185D3F82CDA2624C9544EAA648594E6D544129F890B0|03E8B29AD5055F1DDA1B0E9353DC2C1421974EB3D0A115D0BB35C7D76F50DE20|04234564FE449D51F7E685455FCFAFB3B7721A0B7D1551E3A370F579A3530E04|061C271C0617E56AEB196C834FCAB2D24755AFA50CD95CC6A299D76BE496A858|087F82581B65E3D4AF6F74C8400BE00E|0C1D1A60A0FC143C9FC830BE48C53D488B414921CF4D97D66466FF2A628D1B4D|0D92DC6B1D5E47E815D9A1242F2EE417878D8B941D0E547602AD5FE2590A999B|0FA7C98D793B8C71D6BA29BDE4FD449E497B246F92AB30403330FAE3D8CB6FFD|120B092E8D8212A7C0E796AC320DD10C56C8B801AA8FB234CB577D5F0DABC05C|15224ADEAE393BE5D06378ED32605D677E8C529A395F9BF2ADE9B0163D886C49|1948EBD975715205211E0E61520C37250868F8CFF4977B9978648C65EE7494DD|19A9A43B36D2ED6516E4B1D8368CB3AF64362507D2B30F4CB742FBE50780EE89|1D4CCFA95990FBF6EE731DB78A945BAD5D3FFA82F0271D8C9AEFD314B6ECC6AF|1D7B235E1D790516E7D4643BAE43F5E32B05AFDF6059D5D5FE2FA359C52A7A2F|1D9DF55CA8B3DDA301A4E6A23586E06B39C86ADB1196802AA7787B6C49E15E37|1F233FDB94239FA884321A91D14342C1A66E64CE02DC64378CB7C53669D5EA28|1FEDE186E9D9666CE4EFF1882CE3BDCA66C9A121EA9773D8E57747912E8AD57E|2362E52E347D77A6B101B80057D9770E44A44599889385A83822625901631583|236F2A9FCC1176A802946828029465D054626F92D258015F8ABCCDC52D2365E7|257413C17F63500A76F9D0216A8DEE283021299A61DC0539E6E870FD5D78177B|29547F7CED48000841E1EE6E5DA03BCFB21722D9E60687356AB2D1E000733F21|2A72302C1E76B436DA9F0E37941A6E3C1F9921A54BC0BF78D7FE90CF876A6516|2B31A64F7D221DFD8AC33EDAF101A4C1AC73F36DCD7ABB976517FB1E90750544|32863DAA615AFBB3E90E3DAD35AD47199050333A2AAED57E5065131344206FE1|33DB5B2A2CC592FD10C65BA38396E4C7574AD78E786D78E8A3ACDC93A90C3209|340A759B1C1CDC22F6FAC84044D072475E1630FBB7F47D96C4E18413DE34D570|35D99E0BC26A29A4E8A4B3A0FEE0724A494675B76745DBADBC2F8AFA81C5AC49|37BAE5E29633F171616988FD64CFAE9038CF8167677879A0C4CB4ED4761B9EBF|38BEFEE4C4513DE47E667544D9F705F56C195393B116FCD154755C1F7815AE55|3AA75DA2773573786F07530F5A09B8E0AACD0402FD11E14D8067B5F4607BBD6A|3AF96098CCB1063F1538E255F328E78F9556E29CD0563C53D2A73569759B5D0E|40570E998A0F16239E1587DE3812DA51F58A972D21685F1A90C69282645A46B4|41C1CAD44C0A9AA37B33FF2269AB3232A4EFCB34C21234F1B773EB5A53289C5C|4367007DE8752A8E735F3092D0D574FE120AB6205B28A0BA3B125CD2BA906BE7|43E2AFEDF3F3A5EA9BB238180A76B66695235465CCE0C4AA6A440BD262ADBA63|47D288233A39A68396567E35A77A500E296218DF3A4BC9DACA797E75B4B03D4B|47E870E2D1A123B74C470B0E01ED75EF196C714AEED8739F77AC6E56430DBA35|4A03238E31E3E90B38870FFC0A3CEB3B|4B8DBE4D5A5547C30971CDA34392A943C11964E43F62325DD753620744063B8D|4EE21B5FD8597E494AE9510F440A1D5BBCDB01BC653226E938DF4610EE691F3A|4FA7BAA5CB631A837E5A22AE8F0505FB569A46E2622C551C793BF9450378315C|5634140992891D2382FA103031B96023B75470ECD1BF0CF88006A45E63EF41BC|5699D20B8F7F27F82707B8F745C713437357CFE409432B8DC966FA223BE8F7B4|5B0F61B42E9A6C238C7028751BF75C484778219CF88A7C5007C2A49E14351E70|5BD64A7B018DB5B4538D8077AD7A50871DC6C5682A1F151CC5E8A42673E4384F|5D0BE9AAAD980137D68677D7EF3758D9CE7A4E2D170DF0ABEE803F64B14DCD67|5D6DAC0C7C3FE4891BB4B8D3ADA9CAAA72DCEDF8EC83025331700F208BB493F6|60421CB9998DC07EFC07956FDCB5B73862C5145C108BE6CEC90E529940E3226E|6173E77438AB03089EA688EADE0D801C4083A7C73E9CB1E7C4F57AE0C6034832|6537BDBD6B350022B95421209E5EB8CFD851A556904DD5B7B8A9189B21D40EFB|655C3C304A2FE76D178F7878D6748439|672E093D20A03FA9A4A91D4689BEB0A1B93AB17C6CDA1C527A86E3DB8BB09348|67F14CB9D372A7A295A96A82F2EAB679B7373F3613DF6B8DCF9434482047CAA1|686704B95D8594A70D0305B7702D3518120EF4088795380847A48E313D017B4A|6A11B49472E5EA497098F11AB66BDE3FB6FA1A6762B73CF08F1DFA83EFAE22E6|6A5F68075A632240A04AF8768C3F63EB1FB92DB95C325F1FE4BFA12D8820EB5C|6AF28EB96FE081E131079417FAB6B8D4A6460A2CB6E532C14AF45E1531D796B1|6F0F702FC0F0A5420A1DBAF1AA88B13B557BEBC2631A4157B8E026D80F7651B2|6FFA106AC8D923CA32BC6162374F488B|715CD8F5CE329B92ED0361A50CE7CC907B34746380542C040B85D09D3A4FCFF|71745CEAE53E4F707AF4586118966AFF02F0BC64584363C34F527A10DBC58F2B|72067F1ACE09F18F6E16FD813F10A6F31B369AE9194B35BC80902AA65AAE7DF6|77A3AEFB336C76F444CC00D3C9E3C16F9A7E6A4DDC93BD64837ED0D28C7ED161|7A60171A2366BC7CD2EA97EC50D4D90CF15E8B7C286F3840661AEBEC9F9B75EF|7C854A125B0D2613BBFCD1FB3664C03C61BC3787EC8BDE6BE11A2F75692DA268|7D2F338E631518226AF04BD9608E452202634CD565D48C506EF6E23BFEDCCB6D|7EFE8C83AB4BA8773421D7F897A1C490214118F7924D5A45868B070CAE6899DD|8449F58EBB84DB076809E6701E7195202A3F77DC2EF8A0809451B585C9194D6E|85C3946865956212FD235E18A29E49D47315E3CA913E4A5E2644ED48566CAE0E|85F67196F7F8AC8D855818E6D13C6E09C58950B739E8BE79A1DFDD33CBC298C6|8637B972D5DB5C4CB152B0A42F4866C9B574E68023B7620911AF8E3D472D4701|881D60034E97CFA4E36B8DA907E5D2E130C9F19ABDD386990EE5A9CDCE91D117|896C5898CE95F078E8246F62CCD4B7DA07959B2884362FA9C1933712AEDEB553|8A8A19DFEDB6E5E58AA574C0EE022EDE031FCA179B921424F1A0E799F1892953|8CA6D4D0D27C950E7BC234BC16B0A89BF9122AC5B708FA215CE7BF4009387350|8CD071A056F555C793B95C82F9EFF1FCF60E304A1E9589988E9819F27A754256|8CFAD47521642927F7AB5F7401445393AB916FE2F67072B44CADFA89C11A40FE|9261B47B4FD67523F7AFE640E55CCB95EC8B154B5DFA34A8564986AC3E97FE1A|957B7F7039EF6B3C84F374B6B602466CB196E50E477A37E012423B7A9D72AA7F|974A2E7A367DF0FD708A9A397F0261374E7D32AF7002183D41107D135936F3C1|A6886A3566A1A98072D67F1ACA4A04B5667F97F4DF21B2F54D6108293D7C02B7|A7244954AA33A3D0BBDC5BF098D546135F1B90545AD649F83EB0FE96B741C296|A9934CC506821E82237FDAF471F845E1E027B37841D635F971B8DF6853E9D7F9|A9DCDF037D39E88BC71AE844971E63AA78379D50CE47E8AAAD0E4B1BAF6C7040|A9F25933EB0DC82972D77854034DBC86220088EFF4758A7DF4E65F87EE1745E1|AA07611CE06D7482C1D2D2F26C8721D6833718ABD72360B81598BC2935811DCB|AA96B7F6516F3F8D7D63D61A30B3AF156B92B3E8DACE05C8953DCF82AC96A3C6|AADF94D677FC0710A44B7452368A04C791C154EE644147B58068A00711D98723|AD738AD2B402C8918BDFCF0B90C9D3AAD7802A62CEA735D522351BCA5BF8D1D7|B0844458AAA2EAF3E0D70A5CE41FC2540B7E46BDC402C798DBDFE12B59AB32C3|B57E90F3F5326920735A5EBC884B4AD1B28E97B48BBA4615AB6E7092EA386BD2|B7298AF9DC02C079AEFE56B1F84B3DC28045D3AE841715CD6F0F87568C1C51C6|B883D0FAF8A9F2396A311B6005AB68073FF0E6A09CAFBDC7B58A8439D52409A1|B97CFD0EA14F390894948861CACAFBAD2F88767D52477E339E2C0A6E4316793B|BB426461EF70FFD601CB64A687C62EDDA066B99A79E49D880918300DA5EB6548|BBE2063BD1C92CCC4CC3B0320CA484909BA0DB5E44E508249B8EC24237404B1D|BEB762D325C6C8AE3CB3876C6491913A51A2A79F336BF0509641E1AD9BDDBAEC|BEFFDD959B1F7E11E1C2B31AF2804A07|C15AEDD520EA6C57768C2C00ABE19BEF9842D55582DD705EA56BC260B6773284|C59DC482B521B021813681F99A8570AA0F57A30BCF42D48667EB09AE635CC9A1|C7EDF93B93D377F76965C177C2F4278F15ECF6DCB077D1641C5F30E5CBE0CA6B|C80B9EAEC33249302BE9F38EB6AD9212A82197D853E15450D672F363F5FDD81E|C95C8B01E7A58AFBAE1B0C3A795108AE46B22C3867680DCDB883CA97E6F092A0|C99F4DE75E3C6FE98D6FBBCD0A7DBF45E8C7539EC8DC77CE86CEA2CFAF822B6A|C9F213F89AE4EB4E3EF4EC3CD71D3440ADFDB9AEE07841DA844E4C176FF53869|CAC82566E9167DC82B09308D05194BFC1CE6441A27B51756024C8B6477D75401|CB28E7980BA2F1C718CD96401B9290719E7748AB9987ABCF9AD9E376F6F60B37|CE9E0918D56424D9565D78AEB40FC7AC3117E9E4116E664B35356FC600CED3E9|CFE6B53554AAF19A2ADF3A64AC5133705D6529396DE72A80F88A9446ED5CCC6F|D7BB5C90B0336B6351EC64ECB11CFC7FEEFC2D293BC19DF6CBE83E0F57324BC5|D9F5A846726F11AE2F785F55842C630F|DA89D50220DA32060EF38546D1160162637FF72E3C3FA2268FEBCA9331EB5ADC|DC70CECD5C5839B63D755E1DFCDBE6E0DB6AEDB694635C5600AA50CC15E0C11E|DC70E94F681692E880A8B69FEEF5A9A7AB5142F2B1FAFD76BEE9FD6C2DF86055|DF4F432719D32BE6CC61598E9CA9A982DC0B6F093F8314C8557457729DF3B37F|E058280F4B15C1BE6488049E0BDBA555F1BAF42E139B7251D6B2C230E28E0AEF|E159AEA81405EADA05AAC7C55A7527E734F7AF37F1AE9B51AF290CCF46463CA0|E825F22C39E34C849FF89304E80F69F2C3FC7E6C9FBFF82CBADB4A2028F28CFE|E8DA7FE5CEAD9D6B51E373B065909557D96B2FC8041FD8C7ACED25B6373C3058|EBEA18A2F0840080D033FB9EB3C54A91EB73F0138893E6C29EB7882BF74C1C30|EC87F0A2D3BFA3E685E961AAED68DF89F825AC08759363C27A3A55FD03D93F6F|EE188B38B4AB978E71A84FE20B9609D888832F2F543A5EC6AA112D61450986D1|EEA9B416BA98EC333E14A8E13DB5EBA5EE1B9AD6E9C1E8B2882D5F7FEEA4560E|F139BC8F71A483BA058E2577EF5952B85A74CEBD302632A121E4BBC0D96BB953|F168D4DBCC2A3E70E6C75A70404A62173E46B24F18CCFDB8593F68E9ECAEBF08|F2648196FEAED0A7A4B1F4C2521A07C952D7667225ADE823DC0540564EF1EC14|F52C313277246CCD81420797967AFF0A7353FE0F6BADC77817E842120072EFBD|F7B7F524138F10AD3B0D8145997DB4EE5C90E7D8F76281CFC4A32BC427833236|F7ECBE51ADCDB9D89535B9A5BBFA0BE08867EEAA0B12CF7F43F66D797A909741|FB3DE0512D1EE5F615EDEE5EF3206A95|FC3E7FF40A45BCCD83617EA952ECCDFC93301C6673CCE8DE33B4BF924B8957D9|FC74E8FAF8772293F2947C803C5309C64310C38D8E3F8EFE18271004A9B96BBA|FF6C917C572FE95CF773AED882AA424DBEE87946D6E1D5A55B429427A3B8D3E1|74f7ba176eda94e9caea3139bed2771e|cf743c6f34fc6af42104b480fd0ef79cdfb0da3d1d2c6e113fe7cf8792b237b0|4af16a3a9a38b40f73e2d57d7446145c627f76ac)"
        - field: "logx.*.message"
          operator: "regexp"
          value: "(104-168-132-128.nip.io|us-west.com|va5vkfdihi5forrzsnmins436z3cbvf3sqqkl4lf6l6kn3t5kc5efrad.onion|zohlm7ahjwegcedoz7lrdrti7bvpofymcayotp744qhx6gjmxbuo2yid.onion)"
      minCount: 1
      timeLapse: 60
      save:
      - field: "logx.*.dest_ip"
        alias: "DestinationIP"
      - field: "logx.*.src_ip"
        alias: "SourceIP"
      - field: "logx.*.dest_port"
        alias: "DestinationPort"
      - field: "logx.*.src_port"
        alias: "SourcePort"
      - field: "logx.*.proto"
        alias: "Protocol"
