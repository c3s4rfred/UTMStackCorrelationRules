# Rule version v1.0.0
# From https://docs.github.com/en/developers/webhooks-and-events/webhooks/webhook-events-and-payloads

- name: "GitHub, probable repository vulnerabilities detected"
  severity: "High"
  description: "GitHub sends Dependabot alerts when we detect vulnerabilities affecting your repository.
                A vulnerability is a problem in a project's code that could be exploited to damage the 
                confidentiality, integrity, or availability of the project or other projects that use its code. 
                Vulnerabilities vary in type, severity, and method of attack. 
                When your code depends on a package that has a security vulnerability, this vulnerable 
                dependency can cause a range of problems for your project or the people who use it."
  solution: "<ol>
             <li>Fix the dependencies that triggered the alert.</li>
             <li>See the logs attached to this alert for more information.</li>
             </ol>"
  category: "Repository Vulnerability Alerts"
  tactic: ""
  dataTypes: ["github"]
  reference: 
    - "https://docs.github.com/en/code-security/dependabot/dependabot-alerts/about-dependabot-alerts"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.github.headers.x_github_event"
          operator: "=="
          value: "repository_vulnerability_alert"
      minCount: 1
      timeLapse: 60
      save:
        - field: "logx.github.sender.login"
          alias: "SourceUser"
