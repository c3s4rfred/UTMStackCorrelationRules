# Rule version v1.0.2

- name: "Alert Sample Severity Low"
  severity: "Low"
  description: "This is an example of a low-severity alert generated by UTMStack. 
                Its purpose is to illustrate how a real alert looks like and give you something to practice with during the tutorial."
  solution: "This activity is potentially done after the adversary achieves its objectives on the host. Ensure that previous
      actions, if any, are investigated accordingly with their response playbooks.
      Isolate the involved host to prevent further post-compromise behavior.
      Investigate credential exposure on systems compromised or used by the attacker to ensure all compromised accounts are
      identified. Reset passwords for these accounts and other potentially compromised credentials.
      Run a full antimalware scan. This may reveal additional artifacts left in the system, persistence mechanisms, and malware components.
      Determine the initial vector abused by the attacker and take action to prevent reinfection through the same vector."
  category: "Defense Evasion"
  tactic: "Clear Windows Event Logs"
  dataTypes: ["sample-data", "generic"]
  reference:
    - "https://attack.mitre.org/tactics/TA0005/"
    - "https://attack.mitre.org/techniques/T1070/001/"
  frequency: 60
  search:
    - query: '{"size": 500, "query": {"bool": {"must": [{"match_phrase": {"dataSource": "sample-host"}}, {"match_phrase": {"dataType": "sample-data"}}, {"match_phrase": {"logx.logType": "Example data"}}, {"match_phrase": {"logx.severity": "Low"}}], "filter": [{"range": {"@timestamp": {"gte": "now-3600s", "lte": "now"}}}], "should": [], "must_not": []}}}'
      timeLapse: 3600
      minCount: 1
      save:
        - field: "logx.src_ip"
          alias: "SourceIP"
        - field: "logx.dest_ip"
          alias: "DestinationIP"
        - field: "logx.src_user"
          alias: "SourceUser"
        - field: "logx.dest_user"
          alias: "DestinationUser"
        - field: "logx.src_host"
          alias: "SourceHost"
        - field: "logx.dest_host"
          alias: "DestinationHost"
        - field: "logx.src_port"
          alias: "SourcePort"
        - field: "logx.dest_port"
          alias: "DestinationPort"
