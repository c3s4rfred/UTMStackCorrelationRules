#Based in https://www.sonicwall.com/techdocs/pdf/sonicos-6-5-4-log-events-reference-guide.pdf
#Rule version v1.0.0

- name: "Possible TCP SYN/FIN Denial Of Service Attack detected"
  severity: "High"
  description: "A Denial of Service (DoS) attack is an attempt to make a machine or network resource unavailable to the intended users.
                One common method of attack involves saturating the target machine with external communications requests so that it cannot
                respond to legitimate traffic or the machine responds so slowly that it is essentially useless."
  solution: "You can protect your network against DoS attacks for both IPv4 and IPv6 traffic by configuring the appropriate DoS Settings on the SonicWall Firewall."
  category: "Impact"
  tactic: "Network Denial of Service"
  dataTypes: ["firewall-sonicwall"]
  reference:
    - "https://attack.mitre.org/tactics/TA0040/"
    - "https://attack.mitre.org/techniques/T1498/"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.sonicwall.event_id"
          operator: "=="
          value: "580"
      timeLapse: 60
      minCount: 1
      save:
        - field: "logx.sonicwall.proto"
          alias: "Protocol"
        - field: "logx.sonicwall.user"
          alias: "SourceUser"
        - field: "logx.sonicwall.src_ip"
          alias: "SourceIP"
        - field: "logx.sonicwall.src_port"
          alias: "SourcePort"
        - field: "logx.sonicwall.dest_ip"
          alias: "DestinationIP"
        - field: "logx.sonicwall.dest_port"
          alias: "DestinationPort"
